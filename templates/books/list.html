{% extends 'base.html' %}
{% load static %}

{% block title %}Book Reviews - Igbo Archives{% endblock %}

{% block sub_navigation %}
<nav class="border-b border-border bg-surface-alt/50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
        <div class="flex flex-wrap items-center gap-2">
            <div class="flex-1 min-w-[120px] sm:flex-none sm:w-28">
                <select class="form-select text-xs" id="ratingFilter" name="rating" hx-get="{% url 'books:list' %}"
                    hx-target="#reviewsGrid" hx-include="#tagFilter,#sortFilter,#searchInput" hx-push-url="true">
                    <option value="">All Ratings</option>
                    <option value="5" {% if request.GET.rating == '5' %}selected{% endif %}>5 Stars</option>
                    <option value="4" {% if request.GET.rating == '4' %}selected{% endif %}>4+ Stars</option>
                    <option value="3" {% if request.GET.rating == '3' %}selected{% endif %}>3+ Stars</option>
                </select>
            </div>

            <div class="flex-1 min-w-[140px] sm:flex-none sm:w-32">
                <select class="form-select text-xs" id="tagFilter" name="tag" hx-get="{% url 'books:list' %}"
                    hx-target="#reviewsGrid" hx-include="#ratingFilter,#sortFilter,#searchInput" hx-push-url="true">
                    <option value="">All Tags</option>
                    {% for tag in tags %}
                    <option value="{{ tag.name }}" {% if request.GET.tag == tag.name %}selected{% endif %}>{{ tag.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div class="flex-1 min-w-[120px] sm:flex-none sm:w-28">
                <select class="form-select text-xs" id="sortFilter" name="sort" hx-get="{% url 'books:list' %}"
                    hx-target="#reviewsGrid" hx-include="#ratingFilter,#tagFilter,#searchInput" hx-push-url="true">
                    <option value="-created_at" {% if request.GET.sort == '-created_at' or not request.GET.sort %}selected{% endif %}>Newest</option>
                    <option value="created_at" {% if request.GET.sort == 'created_at' %}selected{% endif %}>Oldest
                    </option>
                    <option value="-rating" {% if request.GET.sort == '-rating' %}selected{% endif %}>Top Rated</option>
                </select>
            </div>

            <div class="flex-1 min-w-[180px] relative">
                <input type="text" class="form-input text-xs pl-8" placeholder="Search books..." id="searchInput"
                    name="search" value="{{ request.GET.search }}" hx-get="{% url 'books:list' %}"
                    hx-trigger="keyup changed delay:500ms" hx-target="#reviewsGrid"
                    hx-include="#ratingFilter,#tagFilter,#sortFilter" hx-push-url="true">
                <i class="fas fa-search absolute left-2.5 top-1/2 -translate-y-1/2 text-text-muted text-xs"></i>
            </div>
        </div>
    </div>
</nav>
{% endblock %}

{% block content %}
<div id="reviewsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
    {% include "books/partials/book_grid.html" %}
</div>
{% endblock %}